(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4963],{72402:function(e,t,r){"use strict";r.d(t,{a:function(){return getAirbaQuantity}});var getAirbaQuantity=function(e,t){if(t){var r=e*+t;return Number.isInteger(r)?r:+r.toFixed(1)}return e}},94673:function(e,t,r){"use strict";r.d(t,{jV:function(){return n.j},V4:function(){return o.V},D9:function(){return c.D},Sv:function(){return u.S}});var n=r(78297);r(76812),r(94220);var o=r(50338),c=r(52203);r(67294);var u=r(21171);r(1050)},50338:function(e,t,r){"use strict";r.d(t,{V:function(){return useEffectAfterMount}});var n=r(67294),useEffectAfterMount=function(e,t){var r=(0,n.useRef)(!1);(0,n.useEffect)(function(){r.current?e():r.current=!0},t)}},76812:function(e,t,r){"use strict";r.d(t,{c:function(){return useForm}});var n=r(59499),o=r(67294);function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach(function(t){(0,n.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var useForm=function(e){var t=(0,o.useState)({values:e,errors:e}),r=t[0],c=t[1];return{form:r,setField:function(e,t){return c({values:_objectSpread(_objectSpread({},r.values),{},(0,n.Z)({},t,e)),errors:_objectSpread(_objectSpread({},r.errors),{},(0,n.Z)({},t,""))})},setFieldError:function(e,t){return c(_objectSpread(_objectSpread({},r),{},{errors:_objectSpread(_objectSpread({},r.errors),{},(0,n.Z)({},t,e))}))},setAllValues:function(t){return c({errors:e,values:_objectSpread(_objectSpread({},r.values),t)})},setAllErrors:function(e){return c(_objectSpread(_objectSpread({},r),{},{errors:_objectSpread(_objectSpread({},r.errors),e)}))}}}},21171:function(e,t,r){"use strict";r.d(t,{S:function(){return useRecommendations}});var n=r(59499),o=r(50029),c=r(4730),u=r(87794),a=r.n(u),i=r(67294),s=r(2409),d=r(49612),l=r(82348),p=["city","codes","deps","condition"];function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach(function(t){(0,n.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var useRecommendations=function(e){var t=e.city,r=e.codes,n=e.deps,u=void 0===n?[]:n,f=e.condition,v=(0,c.Z)(e,p),b=(0,i.useState)({}),m=b[0],h=b[1],_=null==t?void 0:t.city_magento_id,y=null==t?void 0:t.slug;return(0,i.useEffect)(function(){var e,t=(e=(0,o.Z)(a().mark(function _callee(e){var t;return a().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,(0,d.$K)(_objectSpread(_objectSpread({},v),{},{locations:_||y,extended:1,recommenderCode:e}));case 3:if((null==(t=r.sent)?void 0:t.status)!=="error"){r.next=6;break}return r.abrupt("return");case 6:h(function(r){var n=Object.assign({},r);return null!=t&&t.id&&(n[t.id]=t,t.recommendedCode=e),n}),r.next=12;break;case 9:r.prev=9,r.t0=r.catch(0),(0,s.h4)((0,l.e)(r.t0),"error");case 12:case"end":return r.stop()}},_callee,null,[[0,9]])})),function(t){return e.apply(this,arguments)});f&&Promise.all(r.map(function(e){return t(e)}))},u),Object.values(m)}},94220:function(e,t,r){"use strict";r(67294)},86666:function(e,t,r){"use strict";r.d(t,{h:function(){return p},t:function(){return o.t}});var n,o=r(74864),c=r(50029),u=r(87794),a=r.n(u),i=r(57632),s=r(32882),d=r(71594),l=r(99803),p=(n=(0,c.Z)(a().mark(function _callee(e){var t,r,n,o;return a().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return t=e.sku,r=e.updatePreorderData,n={product:{sku:t,type:l.C0.REGULAR,isActive:!0},uuid:(0,i.Z)()},c.next=4,(0,s.f6)(n);case 4:o=c.sent,r(o),(0,d.ib)(o);case 7:case"end":return c.stop()}},_callee)})),function(e){return n.apply(this,arguments)})},71594:function(e,t,r){"use strict";r.d(t,{EX:function(){return availabilityText},ib:function(){return cachePreorder},sw:function(){return h},K:function(){return scrollToView}});var n,o,c=r(50029),u=r(87794),a=r.n(u),i=r(57632),s=r(32882),d=r(99803),cachePreorder=function(e){localStorage.setItem("preorder",JSON.stringify(e)),localStorage.setItem("preorderExpirationDate",new Date(new Date().getTime()+18e5).toISOString())},adaptPromoOrder=function(e){return{id:e.id,chosen_products:e.chosenProducts}},l=(n=(0,c.Z)(a().mark(function _callee(e){var t,r,n,o,c,u;return a().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return t=e.giftsToAdd,r=e.sku,n=e.updatePreorderData,o=e.isActive,c={product:{sku:r,type:d.C0.REGULAR,isActive:o},uuid:(0,i.Z)()},t&&(c.promotion={id:t.id,rules:t.rules.map(adaptPromoOrder)}),a.next=5,(0,s.f6)(c);case 5:u=a.sent,n(u),cachePreorder(u);case 8:case"end":return a.stop()}},_callee)})),function(e){return n.apply(this,arguments)}),scrollToView=function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"center";return null===(t=e.current)||void 0===t?void 0:t.scrollIntoView({block:r,behavior:"smooth"})},p=r(24316),availabilityText=function(e,t){return t?p.eX.PREORDER:e?p.eX.IN_STOCK:p.eX.OUT_OF_STOCK},f=r(11163),v=r.n(f),b=r(2409),m=r(82348),h=(o=(0,c.Z)(a().mark(function _callee(e){var t,r,n,o,c,u,i,s,d,p;return a().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return t=e.sku,r=e.updatePreorderData,o=void 0!==(n=e.isPromo)&&n,c=e.giftsToAdd,i=void 0===(u=e.isActive)||u,d=void 0===(s=e.isTradeIn)?null:s,a.prev=1,p={isPreorder:!0,isTradeIn:d,promo:o},a.next=5,l({giftsToAdd:c,sku:t,updatePreorderData:r,isActive:i});case 5:return a.next=7,v().push({pathname:"/checkout",query:p});case 7:a.next=12;break;case 9:a.prev=9,a.t0=a.catch(1),(0,b.h4)((0,m.e)(a.t0),"error");case 12:case"end":return a.stop()}},_callee,null,[[1,9]])})),function(e){return o.apply(this,arguments)})},89362:function(e,t,r){"use strict";r.d(t,{P:function(){return O}});var n=r(16835),o=r(50029),c=r(87794),u=r.n(c),a=r(78036),i=r(67294),s=r(78753),d=r(50946),l=r(57506),p=r(89411),f=r(92040),v=r(39151),b=r(2409),m=r(82348),useFreshLagger=function(e){var t,r=e.initialQuantity,n=e.onUpdate,c=e.onRemove,a=(0,i.useState)(void 0===r?0:r),s=a[0],d=a[1];return[s,(t=(0,o.Z)(u().mark(function _callee(e,t){var r;return u().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(r=e>0,o.prev=1,!r){o.next=8;break}return o.next=5,n(e,t);case 5:d(e),o.next=11;break;case 8:return o.next=10,c();case 10:d(t||0);case 11:o.next=20;break;case 13:var u;if(o.prev=13,o.t0=o.catch(1),(0,b.h4)((0,m.e)(o.t0),"error"),!((null==(u=o.t0)?void 0:u.quantity)!==void 0)){o.next=20;break}return d(null!==o.t0&&void 0!==o.t0&&o.t0.quantity?null===o.t0||void 0===o.t0?void 0:o.t0.quantity:1),o.next=20,n(null!==o.t0&&void 0!==o.t0&&o.t0.quantity?null===o.t0||void 0===o.t0?void 0:o.t0.quantity:1,t);case 20:case"end":return o.stop()}},_callee,null,[[1,13]])})),function(e,r){return t.apply(this,arguments)})]},h=r(72402),_=r(19380),y=r.n(_),j=r(85893),O=(0,a.Pi)(function(e){var t,r,c=e.sku,a=e.isAirba,b=e.unitMeasurement,m=(0,l.oR)().checkout,_=m.getProductBySku,O=m.updateProduct,g=m.removeFromCart,w=_(c),P=(0,i.useState)(!1),S=P[0],x=P[1],k=(0,p.l)(),A=(null==b?void 0:b.name)&&(null==b?void 0:b.min_step),handleInputActivity=function(){b||x(!S)},C=(t=(0,o.Z)(u().mark(function _callee(e){var t,r=arguments;return u().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t=r.length>1&&void 0!==r[1]?r[1]:-1,a&&e>t&&k.dispatch({event:f.c.FRESH_ADD_TO_CART,data:{ecommerce:(0,v.Zf)({product:w}),current_cart:[]},resetData:{ecommerce:null,current_cart:null}}),n.next=4,O({product:{quantity:e,id:w.id,isActive:!0}});case 4:case"end":return n.stop()}},_callee)})),function(e){return t.apply(this,arguments)}),D=(r=(0,o.Z)(u().mark(function _callee2(){return u().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g(w.id);case 2:case"end":return e.stop()}},_callee2)})),function(){return r.apply(this,arguments)}),E=useFreshLagger({initialQuantity:null==w?void 0:w.quantity,onUpdate:C,onRemove:D}),Z=(0,n.Z)(E,2),R=Z[0],T=Z[1];return null!=w&&w.id?(0,j.jsxs)("div",{className:y().adder,onClick:function(e){e.preventDefault(),e.stopPropagation()},role:"button",tabIndex:0,children:[(0,j.jsx)("button",{className:y().button,onClick:function(){T(R-1)},children:"—"}),(0,j.jsx)(d.g,{match:!S,children:(0,j.jsx)("div",{className:y().amount,onMouseEnter:handleInputActivity,role:"button",tabIndex:0,children:A?"".concat((0,h.a)(R,b.min_step)," ").concat(b.name):"".concat(R," шт")})}),(0,j.jsx)(d.g,{match:S,children:(0,j.jsx)(s.g,{autoComplete:"off",autoFocus:S,fieldSize:"L",id:"adder-input",isRequired:!0,keepLabel:!1,label:"",mask:"999",maskChar:"",onChange:function(e){T(parseInt(e.target.value,10))},onMouseLeave:handleInputActivity,value:String(R),wrapperClassName:""})}),(0,j.jsx)("button",{className:y().button,onClick:function(){T(R+1)},children:"+"})]}):null})},19380:function(e){e.exports={adder:"ProductCartAdder_adder__rEC1i",button:"ProductCartAdder_button__iqul1","fade-in":"ProductCartAdder_fade-in__G62uu",spin:"ProductCartAdder_spin__XP3oY"}}}]);